---
title: 'MongoDB (1):Brief Introduce of MongoDB'
date: 2017-08-18 15:02:16
toc: true
tags:
 - MongoDB
 - NoSQL
---

## MongoDB的基本概念

MongoDB由C++编写，由**10gen**积极维护（主要），社区上也会受到一些贡献。这个项目是**跨平台**的和**开源**的，它能在所有主流操作系统上编译，包括Mac OS X,Windows以及Linux，目遵循的是**GNU-AGPL许可**。

### 一些特点

**1.复制**

MongoDB通过**副本集**（replica set）的拓扑结构提供了复制功能。副本集将数据分布在多台机器上实现冗余，在服务器和网络故障时能提供自动故障转移，此外复制功能还用于扩展数据库的读能力。它可**以把读操作分散到副本集集群的各台机器上**。有点类似于冗余磁盘整列的作用和概念。

**副本集由一个主节点和多个重节点构成，只有主节点既能接受读操作也能接受写操作，而从节点是只读的。**

![QQ图片20170818150958](\img\QQ图片20170818150958.png)

![QQ图片20170818151106](\img\QQ图片20170818151106.png)

<!--more-->

**2.速度和持久性**

MongoDB的默认写操作都是**fire-and-forget**的，不要求数据库应答，如果数据很重要这可以决定是否开启安全模式。
但是从2.0版本开始，journaling日志默认是开启的，日志文件每一100毫秒把所有写操作都记录一遍，如果由于断电之类的原因被中断，则journaling会在服务重启时检查日志和数据文件的一致性

**3.用B-Tree实现的二级索引**

**4.配置很简单，不需要请专门的DBA**

5.水平扩展基于**自动分片（auto-sharding）机制**，十分容易



## 各种NoSQL的简单对比

NoSQL(Not Only SQL),它泛指非关系型数据库。其中NoSQL又可以分类为聚合型数据库和图形数据库（如Neo4j)。

MongoDB就是一种典型的文档型数据库，作为文档型数据库对比于其他的类型有以下的特点：

| 分类   | 典型产品            | 使用场景                   | 优点             | 缺点                           |
| ---- | --------------- | ---------------------- | :------------- | ---------------------------- |
| 文档型  | MongoDB,CouchDB | Web应用                  | 数据结构要求不严，表结构可变 | 查询性能较低，缺乏统一的查询语法             |
| 键值型  | Redis,Riak      | 日志系统或 数据量和访问量极大的应用场景   | 速度快            | 数据无结构化                       |
| 列存储型 | HBase,Cassandra | 分布式文件系统                | 速度很快，容易进行分布式扩展 | 功能局限                         |
| 图形   | Neo4J           | 需要构建复杂关系的情形，如社交应用和推荐系统 | 借用图算法，容易处理复杂关系 | 计算结果时需要对整个图进行计算，比较慢，而且分布式能力差 |

### 与其他非关系型数据库的详细对比

对于Dynamo和Cassndra这样的数据库而言，他们采用了无主节点的结构，能够轻轻松松的添加节点进行扩展，并且他们选择的都是最**终一致性**，**就是读请求返回的不一定是最后一次写的内容**。

而MongoDB提供的是**强一致性**，提供一个主节点，和更加丰富的数据模型，以及二级索引。丰富的数据模型，决定了MongoDB作为更通用的大型可伸缩web应用方案。对比于apache的CouchDB来说，CouchDB采用和JSON纯文本来进行存储，而MongoDB则是BSON二进制格式，且他们在**二级索引的定义方式上也不同**，CouchDB采用MapReduce来进行定义，**CouchDB每个节点都是其他节点的完整副本，它不会把数据分散到多台服务器上**。

## MongoDB的数据组织

MongoDB也采用了层级的数据组织方式：

![HFDI0AM8O_HOJM37GC4OK](\img\HFDI0AM8O_HOJM37GC4OK.png)

##   MongoDB保存了什么

  MongoDB使用操作系统内置的内存映射文件，将对内存的存取操作直接映射到底层的数据文件中。那么MongoDB存取的是什么东西呢？

  对于传统的关系型数据库我们知道，对于一个类如：

```java
class Student{
  public Long sid;
  public String name;
  public Courses[] courses;
}
```

  可能要分为多个表,比如Student,Course,SC表，但是MongoDB把对象序列化为类Json的格式（BSON二进制格式），也许你以前在Java编程中也用过类似方式，以ObjectInputStream/ObjectoutputStream来序列化对象，已达到某些简单应用的简单存储。

```json
{
  sid:1,
  name:'tom',
  courses:[{
  	cid:1020,
  	cname:'Cpp',
  	score:2.5,
  	tid:4028
  },{
    cid:1426,
  	cname:'operating system',
  	score:4,
  	tid:3548
  }]
}
```

## MongoDB的使用场景

  首先可以明确的事实是，非关系型数据库并不是为了取代关系型数据库而衍生的新技术，它有着自己的适用场景，如果所处理的业务有复杂的事务机制，需要很强的一致性和安全性，且数据的结构不经常变动，那么Nosql其实并不适合，这是关系型的优势所在。

  如果我们渴望的应用业务的数据结构经常变动，或者我们希望以类似于树形和图的结构来保存数据，将今后可以方便的扩展为一个集群，MongoDB是适合的。

  现实中，经常混用关系型和非关系型数据库，让他们彼此做一个补充。
